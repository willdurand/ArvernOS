version: 2
jobs:
  build:
    docker:
      - image: circleci/buildpack-deps
    steps:
      - checkout
      - run: sudo apt-get update
      - run: sudo apt-get install nasm xorriso build-essential grub2-common grub-pc-bin
      - run: make
      - run: test -f build/isofiles/boot/kernel.bin
      - run: test -f build/isofiles/boot/initrd.tar
      - run: test -f build/libc-willOS.a
      - run: test -f build/libk-willOS.a
      - run: test -f build/willOS.iso
      - run: make clean test
